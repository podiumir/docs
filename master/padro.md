
- [مقدمه](#menu)
- [پیش از شروع](#menu)
- [سرویس دریافت شهرهای مبدا و مقصد](#menu)
- [سرویس دریافت گزینه های حمل و نقل ](#menu)
- [سرویس ثبت سفارش ](#menu)
- [سرویس دریافت گزینه های نهایی سازی سفارش](#menu)
- [سرویس نهایی سازی سفارش](#menu)
- [سرویس لغو سفارش](#menu)
- [سرویس دریافت اطلاعات سفارش از پادرو](#menu)
- [سرویس دریافت اطلاعات سفارش از شرکت پستی مورد نظر](#menu)
- [خطا ها](#menu)
- [نمونه پست من](#menu)

## مقدمه
<div class="box-end">
</div>

## پیش از شروع

* URL فراخوانی سرویس ها: https://api.pod.ir/srv/sc/nzh/doServiceCall
* تمامی درخواست ها با متد POST ارسال می­شوند.
* Header درخواست:
پارامترهای زیر در Header تمام درخواست ها ثابت است:

<div style="margin:auto">

|           پارامتر    |    توضیحات                                 |
|----------------------|---------------------------------------------|
|    \_token\_    |    API token دریافتی از پنل کسب و کاری    |
|    \_token_issuer\_    |    این پارامتر دارای مقدار ثابت "1" است.    |
|    Content-Type    |    application/x-www-form-urlencoded    |

</div>


* بدنه درخواست:
پارامترهای زیر در بدنه تمام درخواست ها ثابت است:

|    پارامتر    |    توضیحات    |
|-------------------|----------------------------------------------------------------|
|    scProductId    |    شناسه سرویس در حال استفاده    |
|    scApiKey    |    API Key دریافتی برای سرویس مورد   نظر از پنل کسب و کاری     |

* json Object ها در پارامتری به نام body  ارسال می­شوند.
* ساختار پاسخ دریافتی پس از فراخوانی سرویس به صورت زیر است که پاسخ دریافتی از endpoint  مورد نظر در پارامتر result قرار دارد.

```javascript
{
"hasError": false/true,
"messageId": 0,
"referenceNumber": "",
"errorCode": 0,
"count": 0,
"ott": "",
"result": {
"result": "response",
"header": {},
"statusCode":
}
}
```
<div class="box-end">
</div>

## سرویس دریافت شهرهای مبدا و مقصد
با استفاده از این وب سرویس می توانید نام و کد شهرهای مبدا و مقصد که پادرو سرویس دهی دارد را دریافت کنید.
* شناسه سرویس: 43641
* ارامترهای ورودی: ندارد
<div class="box-end">
</div>

## سرویس دریافت گزینه های حمل و نقل
با استفاده از این وب سرویس می توانید شرکت های پستی مختلف و هزینه ارسال را دریافت کنید.

* شناسه سرویس: 43701
* پارامترهای ورودی:
	* یک JSON Object با پارامترها و ساختار زیر ارسال می­شود:

| پارامتر | نوع مقدار | اجباری | توضیحات |
|------------------|-----------|--------|----------------------------|
| source_city | String | بله | کد شهر مبدا سفارش |
| destination_city | String | بله | کد شهر مقصد سفارش |
| parcels | Array | بله | یک آرایه از بسته های سفارش |
| weight | Integer | بله | وزن بسته (کیلوگرم) |
| value | Integer | بله | ارزش بسته (ریال) |
| dimension | Object | بله | مشخصات فیزیکی بسته |
| width | Integer | بله | عرض بسته (سانتی متر) |
| height | Integer | بله | طول بسته (سانتی متر) |
| depth | Integer | بله | ارتفاع بسته (سانتی متر) |

* نمونه JSON ارسالی:

```javascript
{
"source_city": "2301",
"destination_city": "2301",
"parcels": [
{
"weight": 200,
"value": 2000,
"dimension": {
"width": 123,
"height": 20,
"depth": 10
}
},
{
"weight": 200,
"value": 2000,
"dimension": {
"width": 123,
"height": 20,
"depth": 10
}
}
]
}
```
* پاسخ دریافتی: پاسخ دریافتی با پارامترها و ساختار زیر ارسال میشود:

| پارامتر | نوع | توضیحات |
|--------------------|---------|------------------------------------------|
| quotes | Object | آرایه ای از شرکت های پستی  |
| provider_name | String | نام شرکت پستی |
| provider_code | String | کد معادل شرکت پستی در پادرو |
| provider_logo | String | لوگوی شرکت پستی |
| price | Integer | هزینه ارسال (بدون تخفیف) |
| sale_price | Integer | هزینه ارسال (با اعمال تخفیف) |
| discount_value | Integer | میزان تخفیف |
| from_hours | Integer | حداقل زمان لازم برای رسیدن بسته به مقصد |
| to_hours | Integer | حداکثر زمان لازم برای رسیدن بسته به مقصد |
| service_type | String | نوع سرویس |
| service_type_label | String | کد معادل سرویس |

* نمونه JSON  برگشتی:
```javascript
{
"quotes": [
{
"provider_name": "x",
"provider_code": "x1",
"provider_logo": "URL to logo",
"price": 178760,
"sale_price": 128760,
"discount_value": 50000,
"from_hours": 24,
"to_hours": 72,
"service_type": "regular",
"service_type_label": "عادی"
},
{
"provider_name": "y",
"provider_code": "y1",
"provider_logo": "URL to logo",
"price": 110000,
"sale_price": 70000,
"discount_value": 40000,
"from_hours": 24,
"to_hours": 72,
"service_type": "regular",
"service_type_label": "عادی"
}
]
}
```
<div class="box-end">
</div>

## سرویس ثبت سفارش
با استفاده از این وب سرویس می توانید سفارش خود را در سیستم پادرو ثبت نمایید.
* شناسه سرویس: 43741
* پارامترهای ورودی:
	* یک JSON Object با پارامترها و ساختار زیر ارسال می­شود:


| پارامتر | نوع مقدار | اجباری | توضیحات |
|------------------|-----------|--------|------------------------------------------------------------------------------------------------------------------------|
| sender | Object | بله | اطلاعات فرستنده |
| receiver | Object | بله | اطلاعات گیرنده |
| name | String | بله | نام و نام خانوادگی |
| contact | Object | بله | اطلاعات تماس |
| postal_code | String | بله | کد پستی |
| city | String | بله | کد شهر |
| address | String | بله | آدرس پستی |
| phone_number | String | بله | شماره تلفن |
| national_code | String | بله | کد ملی |
| provider_code | String | بله | گزینه های حمل و نقل کد شرکت پستی مد نظر که در وب   سرویس می توانید دریافت کنید |
| payment_type | Integer | بله | روش پرداخت هزینه، اگر فرستنده هزینه را پرداخت میکند   مقدار "1" و اگر گیرنده پرداخت خواهد کرد مقدار "2"   مقداردهی شود |
| receiver_comment | String | بله | توضیحات برای گیرنده |
| parcels | Array | بله | یک آرایه از بسته های سفارش |
| id | Integer | بله | شماره بسته. به صورت دلخواه   مقداردهی میشود. |
| weight | Integer | بله | وزن بسته (کیلوگرم) |
| value | Integer | بله | ارزش بسته (ریال) |
| content | String | بله | محتویات بسته ارسالی |
| dimension | Object | بله | مشخصات فیزیکی بسته |
| width | String | بله | عرض بسته (سانتی متر) |
| height | String | بله | طول بسته (سانتی متر) |
| depth | String | بله | ارتفاع بسته (سانتی متر) |

* نمونه JSON  ارسالی:
```javascript
{
	"sender":
	{
		"name":"علیرضا",
		"contact":
		{
			"postal_code":"123453222",
			"city":"2301",
			"address":"tehran , azadi , second street",
			"phone_number":"09194102262",
			"national_code":"0018862470"
		}
	},
    "receiver":
	{
		"name":"علیرضا",
		"contact":
		{
			"postal_code":"123453222",
			"city":"2301",
			"address":"tehran , azadi , second street",
			"phone_number":"09194102262"
		}
	},
	"provider_code":"chapar",
	"payment_type":1,
	"receiver_comment":"comment body",
	"parcels":
	[
		{
			"id":0,
			"weight":200,
			"value":2000,
			"content":"Phone",
			"dimension":
			{
				"width":"123",
				"height":"20",
               "depth":"10"
			}
		},
		{
			"id":123,
			"weight":200,
			"value":2000,
			"content":"Phone",
			"dimension":
			{
				"width":"123",
				"height":"20",
                                             "depth":"10"
			}
		}
	]
}
```

* پاسخ برگشتی: پاسخ برگشتی پس از فراخوانی این سرویس، یک JSON Object با یک پارامتر به نام order_id  یا همان شماره سفارش است.
<div class="box-end">
</div>

## سرویس دریافت گزینه های نهایی سازی سفارش
با استفاده از این سرویس می­توانید گزینه های لازم خود به منظور نهایی سازی سفارش را دریافت کنید.
* شناسه سرویس: 43773
* پارامترهای ورودی:
	* orderId: شماره سفارش مورد نظر
* پاسخ برگشتی: پاسخ برگشتی یک JSON Object به صورت زیر است:

| پارامتر | نوع | توضیحات |
|-------------------|---------|-----------------------------------------------------------------------|
| options | Object | گزینه های در دسترس برای ساعت جمع آوری بسته |
| option_id | Integer | کد گزینه |
| title | String | توضیحات زمان جمع اوری |
| from | Integer | ساعت شروع بازه جمع اوری |
| to | Integer | ساعت پایان بازه جمع آوری |
| available_options | Object | گزینه های در دسترس برای تاریخ جمع آوری بسته |
| date | String | تاریخ  |
| option_ids | Integer | ساعت های جمع آوری بسته در تاریخ مورد نظر بر اساس   کد گزینه option_id |

* نمونه JSON  برگشتی:
```javascript
{
  "options": [
    {
      "option_id": 1,
      "title": "از ساعت ۹ تا ۱۷",
      "from": 9,
      "to": 17
    }
  ],
  "available_options": [
    {
      "date": "2020-05-28",
      "option_ids": [
        1
      ]
    },
    {
      "date": "2020-05-30",
      "option_ids": [
        1
      ]
    },
    {
      "date": "2020-05-31",
      "option_ids": [
        1
      ]
    }
  ]
}
```
<div class="box-end">
</div>

## سرویس نهایی سازی سفارش
برای استفاده از این وب سرویس شما باید ابتدا گزینه های حمل و نقل را از وب سرویس "گزینه های نهایی سازی سفارش" دریافت کنید.
* شناسه سرویس: 43774
* پارامترهای ورودی:
	* orderId: شماره سفارش
	* یک json object با پارامترها و ساختار زیر:

| پارامتر | نوع مقدار | اجباری | توضیحات |
|-------------|-----------|--------|--------------------------------------------------------------------------------|
| pickup_date | String | بله | تاریخ جمع آوری که در وب سرویس گزینه های نهایی سازی   سفارش دریافت نموده اید |
| option_id | Integer | بله | شماره گزینه ارسال که در وب سرویس گزینه های نهایی سازی   سفارش دریافت نموده اید |
| comment | String | بله | توضیحات |


* نمونه JSON  ارسالی:
```javascript
{
	"pickup_date":"2020-05-26",
	"option_id":1,
	"comment":""
}
```

* پاسخ برگشتی: پاسخ برگشتی از این سرویس دارای HTTP Code 200 به معنای موفقیت آمیز بودن نهایی سازی است. در متن پاسخ برگشتی پارامتری وجود ندارد.

* نمونه پاسخ برگشتی:
```javascript
{}
```
<div class="box-end">
</div>

## سرویس لغو سفارش
با استفاده از این وب سرویس می توانید سفارشی که قبلا ثبت شده را لغو کنید.
* شناسه سرویس: 43776
* پارامترهای ورودی:
	* orderId (اجباری): شماره سفارش
	* note  (توضیحات اختیاری راجع به لغو سفارش)
* پاسخ برگشتی: پاسخ برگشتی از این سرویس دارای HTTP Code 200 به معنای موفقیت آمیز بودن نهایی سازی است. در متن پاسخ برگشتی پارامتری وجود ندارد.

<div class="box-end">
</div>

## سرویس دریافت اطلاعات سفارش از پادرو
با استفاده از این وب سرویس می توانید مشخصات سفارش های ثبت شده را دریافت نمایید.
* شناسه سرویس: 43775
* پارامترهای ورودی:
	* orderId: شماره سفارش
* پاسخ برگشتی: یک json object به صورت زیر است:

```javascript
{
  "id": "",
  "price": 110000,
  "discount": 40000,
  "sale_price": 70000,
  "order_detail": {
    "sender": {
      "name": "",
      "contact": {
        "lat": 0,
        "city": "2301",
        "long": 0,
        "address": "",
        "postal_code": "123456",
        "phone_number": "09120000000",
        "national_code": "123456"
      }
    },
    "parcels": [
      {
        "id": 0,
        "value": 1170000,
        "weight": 0.03,
        "content": "فلش مموری",
        "dimension": {
          "depth": 0,
          "width": 10,
          "height": 15
        }
      }
    ],
    "receiver": {
      "name": "",
      "comment": "comment body",
      "contact": {
        "lat": 0,
        "city": "2301",
        "long": 0,
        "address": "",
        "postal_code": "123456",
        "phone_number": "123456"
      }
    },
    "tracking_id": 123456,
    "parcel_total": {
      "total_value": 1170000,
      "total_weight": 0
    },
    "reference_id": null,
    "service_type": "regular",
    "provider_code": ""
  },
  "pickup_time": "2020-05-23 14:00:00",
  "pickup_to_time": "19:00:00",
  "payment_type": 1,
  "status": "provider_seen",
  "provider_code": ""
}
```
اکثر پارامترها در سرویس های قبلی مورد استفاده قرار گرفته اند، پارامترهای دیگر عبارتند از:

|    توضیحات    |    نوع    |    پارامتر    |
|-----------------------------------------------------|---------------|----------------------|
|    شماره سفارش    |    Integer    |    id    |
|    طول جغرافیایی    |    Integer    |    lat    |
|    عرض جغرافیایی    |    Integer    |    long    |
|    شماره پیگیری    |    Integer    |    tracking_id    |
|    مشخصات کل بسته (های) ارسالی    |    Object    |    parcel_total    |
|    ارزش کل    |    Integer    |    total_value    |
|    وزن کل    |    Integer    |    total_weight    |
|    مقداری است که میتواند توسط شرکت پستی داده شود    |    Integer    |    reference_id    |
|    تاریخ جمع آوری و ساعت شروع    |    String    |    pickup_time    |
|    ساعت پایان جمع اوری    |    String    |    pickup_to_time    |
|    وضعیت سفارش (1)    |    String    |    status    |

(1) این پارامتر می­تواند دارای مقادیر زیر باشد:

| پارامتر | توضیحات |
|----------------------|--------------------------------------------------------------|
| pending | سفارش روی api پادرو ثبت شده ولی هنوز زمان جمع آوری مشخص نشده |
| finalized | زمان جمع آوری مشخص شده ولی بر روی api شرکت مورد نظر ثبت نشده |
| provider_seen | زمان جمع آوری مشخص شده و بر روی api شرکت مورد نظر ثبت شده |
| pending_cancellation | سفارش در انتظار لغو است |
| cancel | سفارش لغو شده است |
| rejected | سفارش از طرف ادمین پادرو رد شده است |

<div class="box-end">
</div>

## سرویس دریافت اطلاعات سفارش از شرکت پستی مورد نظر
با استفاده از این سرویس می­توانید وضعیت سفارش خود را در شرکت پستی دریافت کنید.
* شناسه سرویس: 44529
* پارامترهای ورودی:
	* orderId: شماره سفارش
* پاسخ برگشتی: یک json object به صورت زیر است:

|    پارامتر    |    توضیحات    |
|-------------------|-------------------------|
|    order_state    |    وضعیت سفارش    |
|    text    |    توضیح وضعیت سفارش    |

پارامتر order_state می­تواند دارای مقادیر زیر باشد:

| پارامتر | توضیحات |
|----------------------------|----------------------------------------------------------------------|
|    pending    |    سفارش روی api پادرو ثبت   شده ولی هنوز زمان جمع آوری مشخص نشده    |
|    finalized    |    زمان جمع آوری مشخص شده ولی بر روی api شرکت مورد نظر ثبت نشده    |
|    provider_seen    |    زمان جمع آوری مشخص شده و بر روی api شرکت مورد نظر ثبت شده    |
|    pending_cancellation    |    سفارش در انتظار لغو است    |
|    cancel    |    سفارش لغو شده است    |
|    rejected    |    سفارش از طرف ادمین پادرو رد شده است    |

* نمونه json برگشتی:
```javascript
{
  "order_state": "provider_seen",
  "text": "دیده شده"
}

```

<div class="box-end">
</div>

## خطا ها

<div class="box-end">
</div>

## نمونه پست من
https://podspace.pod.ir/nzh/drive/downloadFile?hash=HBV2JV7CHSF2M4SI
<div class="box-end">
</div>
