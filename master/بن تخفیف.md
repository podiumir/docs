- [مقدمه](#menu)
- [شارژ اعتبار](#menu)
- [بن تخفیف مبلغی](#menu)
- [بن تخفیف درصدی](#menu)
- [اعمال بن تخفیف به فاکتور](#menu)
- [لیست و جستجو بن‌ تخفیف ها](#menu)
- [فعال و غیرفعال‌ سازی بن تخفیف](#menu)
- [لینک‌های مرتبط](#menu)


## مقدمه

**تمام امکانات بن تخفیف در پکیج billing قرار دارد.برای اطلاعات بیشتر به [پکیج سرویس‌ها](/documents/packages/) مراجعه کنید**

در این مستند نحوه استفاده از زیرساخت تخفیفی پاد توضیح داده خواهد شد.
**بن تخفیف:** کدی است که با اعمال آن به فاکتور، مبلغ یا درصدی از فاکتور کسر می‌شود.
**شارژ اعتبار:** کدی است که با اعمال آن، کیف پول کاربر شارژ می‌شود.

<div class="box-end">
</div>

## شارژ اعتبار

جهت تعریف شارژ اعتبار، سرویس زیر را فراخوانی نمایید:

<br/>
توجه داشته باشید به ازای هر شارژ اعتبار، باید مقادیر تعداد، مبلغ، نام و توضیحات در پارامترهای جداگانه ارسال گردند.

<br/>
جهت تعریف شارژ اعتبار، لازم است در صنف خود حتما اعتبار داشته باشید، هم‌چنین می‌توانید کد هش را به صورت دلخواه تعریف نمایید.

<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
        var output = new ResultSrv<List<VoucherSrv>>();
        var defineCreditVoucherVo= DefineCreditVoucherVo.ConcreteBuilder
                .SetServiceCallParameters(internalServiceCallVo)
                .SetGuildCode(GuildCode)
                .SetExpireDate("1398/08/01")
                .SetVouchersContent(new List<VoucherContentVo>
                {
                VoucherContentVo.ConcreteBuilder.SetName("BonTst1").SetAmount(0).SetCount(1).SetDescription("tst").SetHashCodes(new []{"yuoeve"}).Build(),
                VoucherContentVo.ConcreteBuilder.SetName("BonTst2").SetAmount(0).SetCount(2).SetDescription("tst").SetHashCodes(new []{"rewqeve","bnmeve"}).Build()
                })
                //.SetLimitedConsumerId(3)
                //.SetCurrencyCode("IRR")
                .Build();
        BillingService.DefineVoucher(defineCreditVoucherVo, response => Listener.GetResult(response, out output));   
    }
catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineCreditVoucher</div>

# [Java](#tab/java)

``` java
//List<String> scVoucherHashs =new ArrayList<>();
//scVoucherHashs.add("RFSFGDYEDYGS");
BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
        .setToken({token})
        .setToken_issuer(1)
        //.setScApiKey("SDFJKSHFJwshfJshfDJH")
        /.setScVoucherHash(scVoucherHashs)
        .setServerType(Enum_Server_type.SANDBOX)
        .build();

BillingService billingService = new BillingService();



Voucher[] vouchers = {new Voucher({count}, {amount},{name},{description})};
    List<String> hashs= new ArrayList<>();
    hashs.add({hashs})

try {
    DefineCreditVoucherVo defineCreditVoucherVo = new DefineCreditVoucherVo.Builder(baseInfoVo)
            .setGuildCode({guildCode})
            .setExpireDate({expierDate})
            .setVouchers(vouchers)
            //.setLimitedConsumerId({limitedConsumerId})
            //.setCurrencyCode({currencyCode})
            //.setHashCode(hashs)
            .build();
    billingService.defineCreditVoucher(defineCreditVoucherVo, new OnGetResponseListener<List<VoucherSrv>>() {
        @Override
        public void onResponse(ResultVo<List<VoucherSrv>> result) {
            System.out.println(result.getResult().get(0).getName());
        }

        @Override
        public void onFailed(PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    });
} 
catch (PodException e) {
    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
}

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineCreditVoucher</div>

# [PHP](#tab/php)

``` php
$param = 
[
    ## ====================== *Required Parameters  ==================
        'guildCode'     => "{Put guild code}",
        'expireDate'    => "{Put expire date yyyy/mm/dd}",
        'vouchers'      => [
            [
                'count'         => '{Put count of voucher}',
                'amount'        => '{Put price}',
                'name'          => '{Put name of voucher}',
                'description'   => '{Put description}',
                ## ============= Optional Parameters  ==============
                'hash'         => '{Put voucher hash}'
            ],...
        ],
## ================== Optional Parameters  ===================
        'limitedConsumerId' => '{Put user id}',
        'currencyCode'      => '{Put currency code}'
        'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
        'scApiKey'           => '{Put service call Api Key}'
];
try {
    $result = $BillingService->defineCreditVoucher($param);
    print_r($result);
}
catch (ValidationException $e) {
    print_r($e->getResult());
    print_r($e->getErrorsAsArray());
} catch (PodException $e) {
    print_r($e->getResult());
}

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineCreditVoucher</div>

# [Nodejs](#tab/nodejs)

``` javascript
let defineCreditVoucherData = {
  // ------ REQUIRED ------
  guildCode: 'GUILD CODE',
  expireDate: 'YYYY/MM/DD',
  vouchers: [
    {
      // ------ REQUIRED ------
      count: 0,
      amount: 0,
      name: 'NAME',
      description: 'DESCRIPTION'

      // ------ OPTIONAL ------
      // hash: 'HASH'
    },
    {
      // ------ REQUIRED ------
      count: 0,
      amount: 0,
      name: 'NAME',
      description: 'DESCRIPTION'

      // ------ OPTIONAL ------
      // hash: 'HASH'
    }
  ]

  // ------ OPTIONAL ------
  // limitedConsumerId: 0
  // currencyCode: 'CURRENCY'
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiKey: ' SC API KEY'
};

 podBillingService.defineCreditVoucher(defineCreditVoucherData)
      .then(function (result) {
        console.log('function: defineCreditVoucher ============>', result, '\n');
      })
      .catch(function (error) {
        console.log('error defineCreditVoucher ============>', error);
      });
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineCreditVoucher</div>

<div class="tab-end">
</div>

<div class="box-end">
</div>

## بن تخفیف مبلغی

برای ساخت بن تخفیف با مبلغ مشخص، سرویس زیر را فراخوانی نمایید؛می‌توانید با یک بار فراخوانی سرویس، برای چند کاربر بن تخفیف تعریف نمایید، اما توجه داشته باشید به ازای هر کاربر، کد هش متفاوتی دریافت خواهید کرد و مشتری با اعمال کد هش می‌تواند از بن تخفیف تعریف شده استفاده نماید.

<br/>

توجه داشته باشید به ازای هر بن تخفیف، باید مقادیر تعداد، مبلغ، نام و توضیحات در پارامترهای جداگانه ارسال گردند.

<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<List<VoucherSrv>>();
            var defineDiscountAmountVoucherVo = DefineDiscountAmountVoucherVo.ConcreteBuilder
                    .SetServiceCallParameters(internalServiceCallVo)
                    .SetGuildCode({Put your GuildCode})
                    .SetExpireDate("{Put your ExpireDate}")
                    .SetVouchersContent(new List<VoucherContentVo>
                    {
                        VoucherContentVo.ConcreteBuilder.SetName("{Put your Name}").SetAmount({Put your 
                        Amount}).SetCount({Put your Count}).SetDescription("{Put your Description}").SetHashCodes({Put your 
                        HashCode}).Build(),

                        VoucherContentVo.ConcreteBuilder.SetName("{Put your Name}").SetAmount({Put your 
                        Amount}).SetCount({Put your Count}).SetDescription("{Put your Description}").SetHashCodes({Put your 
                        HashCode}).Build()
                    })
                    //.SetLimitedConsumerId({Put your LimitedConsumerId})
                    //.SetCurrencyCode("{Put your CurrencyCode}")
                    //.SetEntityId({Put your EntityId})
                    //.SetDealerBusinessId({Put your DelareBusinessId})
                    .Build();
            BillingService.DefineVoucher(defineDiscountAmountVoucherVo, response => Listener.GetResult(response, out output));
    }
catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineDiscountAmountVoucher</div>

# [Java](#tab/java)

``` java

//List<String> scVoucherHashs =new ArrayList<>();
//scVoucherHashs.add("RFSFGDYEDYGS");
BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
        .setToken({token})
        .setToken_issuer(1)
        //.setScApiKey("SDFJKSHFJwshfJshfDJH")
        //.setScVoucherHash(scVoucherHashs)
        .build();

BillingService billingService = new BillingService();



List<Long> entityIds= new ArrayList<>();
entityIds.add({entityId1});
entityIds.add({entityId2});
    Voucher[] vouchers = {new Voucher({count}, {amount},{name},{description})};
List<String> hashs= new ArrayList<>();
    hashs.add({hashs})


try {
    DefineDiscountAmountVoucherVo defineDiscountAmountVoucherVo = new DefineDiscountAmountVoucherVo.Builder(baseInfoVo)
            .setGuildCode({guildCode})
            .setExpireDate({expireDate})
            .setVouchers(vouchers)
            //.setEntityId(entityIds)
            // .setLimitedConsumerId({limitedCosumerId})
            // .setCurrencyCode({currencyCode})
            // .setHashCode(hashs)
            .build();
    billingService.defineDiscountAmountVoucher(defineDiscountAmountVoucherVo, new OnGetResponseListener<List<VoucherSrv>>() {
        @Override
        public void onResponse(ResultVo<List<VoucherSrv>> result) {
            System.out.println(result.getResult().get(0).getProductList().get(0).getBusiness().getName());
        }

        @Override
        public void onFailed(PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    });
} 
catch (PodException e) {
    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
}

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineDiscountAmountVoucher</div>

# [PHP](#tab/php)

``` php
$param =
        [
            ## ===================== *Required Parameters  ===================
            'guildCode'     => "INFORMATION_TECHNOLOGY_GUILD",
            'expireDate'   => "{Put expire date yyyy/mm/dd}",
            'vouchers'      => [
                [
                    'count'         => '{Put count of voucher}',
                    'amount'        => '{Put price}',
                    'name'          => '{Put name of voucher}',
                    'description'   => '{Put description}',
                    ## ========= Optional Parameters  =========
                    'hash'          => '{Put voucher hash}'
                ], ....
            ],
            ## ====================== Optional Parameters  ==================
            'productId'         => ['{Put product ids}'],
            'dealerBusinessId'  => ['{Put dealer business ids}'],
            'limitedConsumerId' => '{Put user id}',
            'currencyCode'      => '{Put currency code}',
            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
            'scApiKey'           => '{Put service call Api Key}', 
    ];
    try {
        $result = $BillingService->defineDiscountAmountVoucher($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineDiscountAmountVoucher</div>

# [Nodejs](#tab/nodejs)

``` javascript

let defineDiscountAmountVoucherData = {
  // ------ REQUIRED ------
  guildCode: 'GUILD CODE',
  expireDate: 'YYYY/MM/DD',
  vouchers: [
    {
      // ------ REQUIRED ------
      count: 0,
      amount: 0,
      name: 'NAME',
      description: 'DESCRIPTION'

      // ------ OPTIONAL ------
      // hash: 'HASH'
    },
    {
      // ------ REQUIRED ------
      count: 0,
      amount: 0,
      name: 'NAME',
      description: 'DESCRIPTION'

      // ------ OPTIONAL ------
      // hash: 'HASH'
    }
  ]

  // ------ OPTIONAL ------
  // productId: [0, 0]
  // dealerBusinessId: [0, 0]
  // limitedConsumerId: 0
  // currencyCode: 'CURRENCY'
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiKey: ' SC API KEY'
};

 podBillingService.defineDiscountAmountVoucher(defineDiscountAmountVoucherData)
      .then(function (result) {
        console.log('function: defineCreditVoucher ============>', result, '\n');
      })
      .catch(function (error) {
        console.log('error defineCreditVoucher ============>', error);
      });
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineDiscountAmountVoucher</div>

<div class="tab-end">
</div>

<div class="box-end">
</div>



## بن تخفیف درصدی

جهت تعریف بن تخفیف، در قالب درصد سرویس ذیل را فراخوانی نمایید:

<br/>
توجه داشته باشید به ازای هر بن تخفیف، باید مقادیر تعداد، درصد، نام و توضیحات در پارامترهای جداگانه ارسال گردند.

<br/>

در صورت تعیین سقف مبلغ برای بن درصدی، در صورتی که بن بیش از یکبار قابل استفاده باشد، در دفعات بعدی مبلغ باقیمانده نسبت به سقف تعیین شده، قابل استفاده است.

<br/>
در تعریف بن تخفیف درصدی **GuildCode** بعنوان حوزه ی مصرف بن اجباری است.

<br/>

در بخش زیر جدول راهنمای استفاده از انواع **Type** های بن تخفیف درصدی ارائه شده است. همچنین حالت های مختلف ارسال یا عدم ارسال مقادیر **productId** و **limitedConsumerId** نیز توضیح داده شده است.

<br/>

### Type 4 : یکبار مصرف برای یک آیتم

<br/>

| ProductId | limitedConsumerId | با فرض اینکه فاکتور در صنف منطبق با بن صادر شده باشد و زمان انقضای بن نگذشته باشد                                                                      |
| --------- | ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| خیر       | خیر               | بن تخفیف فقط برای یک عدد از یک بند فاکتور و فقط یکبار قابل اعمال                                                                                       |
| بله       | خیر               | بن تخفیف فقط برای یک عدد از یک بند از فاکتور در صورتی که برابر با یکی از محصولات مجاز باشد قابل اعمال است                                              |
| خیر       | بله               | بن تخفیف فقط برای یک عدد از یک بند فاکتوری قابل اعمال است که برای یکی از کاربران مجاز صادر شده باشد                                                    |
| بله       | بله               | بن تخفیف فقط برای یک عدد از یک بند فاکتور در صورتی که برابر با یکی از محصولات مجاز باشد و فاکتور برای یکی از کاربران مجاز صادر شده باشد قابل اعمال است |


<br/>


### Type 8 : بدون محدودیت

<br/>

| ProductId | limitedConsumerId | با فرض اینکه فاکتور در صنف منطبق با بن صادر شده باشد و زمان انقضای بن نگذشته باشد                              |
| --------- | ----------------- | -------------------------------------------------------------------------------------------------------------- |
| خیر       | خیر               | بن تخفیف بدون محدودیت به دفعات نامحدود قابل استفاده است                                                        |
| بله       | خیر               | بن فقط برای محصولات مجاز به دفعات قابل استفاده است                                                             |
| خیر       | بله               | بن تخفیف فقط برای فاکتورهایی که به نام کاربران مجاز صادر شده باشد به دفعات قابل استفاده است                    |
| بله       | بله               | بن تخفیف فقط برای فاکتورهایی که به نام کاربران مجاز صادر شده و فقط برای محصولات مجاز به دفعات قابل استفاده است |


<br/>


### Type 16 : یکبار مصرف برای یک فاکتور
  

<br/>

| ProductId | limitedConsumerId | با فرض اینکه فاکتور در صنف منطبق با بن صادر شده باشد و زمان انقضای بن نگذشته باشد |
| --------- | ----------------- | --------------------------------------------------------------------------------- |
| خیر       | خیر               | بن تخفیف برای کل محصولات یک فاکتور و کل مصرف کنندگان قابل اعمال است               |
| بله       | خیر               | بن تخفیف فقط برای محصولات مجاز شده  فاکتور قابل اعمال است                         |
| خیر       | بله               | بن تخفیف برای کل محصولات فاکتور و کاربران مجاز قابل استفاده است                   |
| بله       | بله               | بن تخفیف برای محصولات مجاز شده در فاکتور و کاربران مجاز شده  قابل استفاده است     |


<br/>

<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            
            var output = new ResultSrv<List<VoucherSrv>>();
            var defineDiscountPercentageVoucherVo = DefineDiscountPercentageVoucherVo.ConcreteBuilder
                    .SetServiceCallParameters(internalServiceCallVo)
                    .SetGuildCode({Put your GuildCode})
                    .SetExpireDate("{Put your ExpireDate}")
                    .SetVouchersContent(new List<DiscountVoucherContentVo>
                    {
                        DiscountVoucherContentVo.ConcreteBuilder.SetName("{Put your Name}").SetAmount({Put your 
                        Amount}).SetCount({Put your Count}).SetDescription("{Put your Description}").SetHashCodes({Put your 
                        HashCode}).SetDiscountPercentage({Put your DiscountPercentage}).Build(),

                        DiscountVoucherContentVo.ConcreteBuilder.SetName("{Put your Name}").SetAmount({Put your 
                        Amount}).SetCount({Put your Count}).SetDescription("{Put your Description}").SetHashCodes({Put your 
                        HashCode}).SetDiscountPercentage({Put your DiscountPercentage}).Build(),
                    })
                    .SetType({Put your VoucherType})
                    //.SetLimitedConsumerId({Put your LimitedConsumerId})
                    //.SetCurrencyCode("{Put your CurrencyCode}")
                    //.SetEntityId({Put your EntityId})
                    //.SetDealerBusinessId({Put your DealerBusinessId})
                    .Build();
            BillingService.DefineVoucher(defineDiscountPercentageVoucherVo, response => Listener.GetResult(response, out output));
    }
catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineDiscountPercentageVoucher</div>

# [Java](#tab/java)

``` java
//List<String> scVoucherHashs =new ArrayList<>();
//scVoucherHashs.add("RFSFGDYEDYGS");
BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
        .setToken({token})
        .setToken_issuer(1)
//.setScApiKey("SDFJKSHFJwshfJshfDJH")
//.setScVoucherHash(scVoucherHashs)
        .build();
BillingService billingService = new BillingService();

List<Long> entityIds= new ArrayList<>();
entityIds.add({entityId1});
entityIds.add({entityId2});
List<Integer> discountPercentages = new ArrayList<>();
discountPercentages.add({discountPercentags});
Voucher[] vouchers = {new Voucher({count}, {amount},{name},{description})};
Enum_Server_type_Percent type_percent =Enum_Server_type_Percent.eight;
List<String> hashs= new ArrayList<>();
    hashs.add({hashs})


try {
    DefineDiscountPercentageVoucherVo defineDiscountPercentageVoucherVo = new DefineDiscountPercentageVoucherVo.Builder(baseInfoVo)
            .setGuildCode({guildCode})
            .setExpireDate({expireDate})
            .setVouchers(vouchers)
            .setType(type_percent)
            .setDiscountPercentage(discountPercentages)
//.setEntityId(entityIds)
//.setLimitedConsumerId({limitedConsumerId})
//.setCurrencyCode({currencyCode})
//.setHashCode(hashs)
            .build();
    billingService.defineDiscountPercentageVoucher(defineDiscountPercentageVoucherVo, new OnGetResponseListener<List<VoucherSrv>>() {
        @Override
        public void onResponse(ResultVo<List<VoucherSrv>> result) {
            System.out.println(result.getResult().get(0).getHash());
        }

        @Override
        public void onFailed(PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    });
} 
catch (PodException e) {
    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
}

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineDiscountPercentageVoucher</div>

# [PHP](#tab/php)

``` php
$param =
        [
        ## ============================ *Required Parameters  =========================
            'guildCode'     => "INFORMATION_TECHNOLOGY_GUILD",
            'expireDate'    => "1398/12/29",
            "type"          => '{Put type enum(1, 2, 4, 8, 16)}',
            'vouchers'      => [
                [
                    'count'         => '{Put count of voucher}',
                    'discountPercentage' => '{Put discount percentage}',
                    'name'          => '{Put name of voucher}',
                    'description'   => '{Put description}',
                    ## ============= Optional Parameters  ==============
                    'hash'          => '{Put voucher hash}',
                    'amount'        => '{Put maximum price}',
                ],...
            ],
        ## =========================== Optional Parameters  ===========================
            'productId'         => ['{Put product ids}'],
            'dealerBusinessId'  => ['{Put dealer business ids}'],
            'limitedConsumerId' => '{Put user id}',
            'currencyCode'      => '{Put currency code}',
            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
            'scApiKey'           => '{Put service call Api Key}', 
    ];
    try {
        $result = $BillingService->defineDiscountPercentageVoucher($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineDiscountPercentageVoucher</div>

# [Nodejs](#tab/nodejs)

``` javascript
let defineDiscountPercentageVoucherData = {
  // ------ REQUIRED ------
  guildCode: 'GUILD CODE',
  expireDate: 'YYYY/MM/DD',
  vouchers: [
    {
      // ------ REQUIRED ------
      count: 0,
      amount: 0,
      name: 'NAME',
      discountPercentage: 0,
      description: 'DESCRIPTION'

      // ------ OPTIONAL ------
      // hash: 'HASH'
    },
    {
      // ------ REQUIRED ------
      count: 0,
      amount: 0,
      name: 'NAME',
      discountPercentage: 0,
      description: 'DESCRIPTION'

      // ------ OPTIONAL ------
      // hash: 'HASH'
    }
  ],
  type: 0 // 4 | 8 | 16

  // ------ OPTIONAL ------
  // productId: [0, 0]
  // dealerBusinessId: [0, 0]
  // limitedConsumerId: 0
  // currencyCode: 'CURRENCY'
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiKey: ' SC API KEY'
};

 podBillingService.defineDiscountPercentageVoucher(defineDiscountPercentageVoucherData)
      .then(function (result) {
        console.log('function: defineDiscountPercentageVoucher ============>', result, '\n');
      })
      .catch(function (error) {
        console.log('error defineDiscountPercentageVoucher ============>', error);
      });
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/defineDiscountPercentageVoucher</div>

<div class="tab-end">
</div>

<div class="box-end">
</div>


## اعمال بن تخفیف به فاکتور

بعد از تعریف بن تخفیف برای اعمال بن تخفیف به فاکتور(درصورتی که پارامتر postVoucherEnabled در صدور فاکتور را با مقدار true ارسال نموده باشید)، سرویس زیر را فراخوانی نمایید:

<br/>

بن تخفیف جهت اعمال روی یک فاکتور، می‌تواند بیش از یک مورد باشد.

<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<InvoiceSrv>();
            var applyVoucherVo = ApplyVoucherVo.ConcreteBuilder
                    .SetServiceCallParameters(internalServiceCallVo)
                    .SetInvoiceId({Put your InvoiceId})
                    .SetVoucherHash({Put your VoucherHash})
                    .SetOtt("{Put your Ott}")
                    //.SetPreview({Put your Preview})
                    .Build();
            BillingService.ApplyVoucher(applyVoucherVo, response => Listener.GetResult(response, out output));
            
    }
catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/applyVoucher</div>

# [Java](#tab/java)

``` java
//List<String> scVoucherHashs =new ArrayList<>();
//scVoucherHashs.add("RFSFGDYEDYGS"); 
BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
        .setToken({token})
        .setToken_issuer(1)
        .setOtt({ott})
        //.setScApiKey("SDFJKSHFJwshfJshfDJH")
        //.setScVoucherHash(scVoucherHashs)
        .build();

BillingService billingService = new BillingService();



List<String> voucherHashs = new ArrayList<>();
voucherHashs.add({voucherHash});


try {
    ApplyVoucherVo applyVoucherVo = new ApplyVoucherVo.Builder(baseInfoVo)
            .setInvoiceId({invoiceId})
            .setVoucherHash(voucherHashs)
            //.setPreview()
            .build();
    billingService.applyVoucher(applyVoucherVo, new OnGetResponseListener<InvoiceSrv>() {
        @Override
        public void onResponse(ResultVo<InvoiceSrv> result) {
            System.out.println(result.getResult().getDescription());
        }

        @Override
        public void onFailed(PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    });
} 
catch (PodException e) {
    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
}


```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/applyVoucher</div>

# [PHP](#tab/php)

``` php
$param =
        [
        ## ============================ *Required Parameters  =========================
            'invoiceId'     => '{Put invoice id}',
            'voucherHash'   => ['{Put voucher hash}'],
            '_ott_'         => '{Put ott}',
         ## =========================== Optional Parameters  ===========================
            'preview'       => '{Put true/false}',
            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
            'scApiKey'           => '{Put service call Api Key}', 
        ];
    try {
        $result = $BillingService->applyVoucher($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/applyVoucher</div>

# [Nodejs](#tab/nodejs)

``` javascript

let applyVoucherData = {
  // ------ REQUIRED ------
  _ott_: 'OTT',
  invoiceId: 0,
  voucherHash: ['HASH']

  // ------ OPTIONAL ------
  // preview: true | false,
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiKey: ' SC API KEY'
};

 podBillingService.applyVoucher(applyVoucherData)
      .then(function (result) {
        console.log('function: defineDiscountPercentageVoucher ============>', result, '\n');
      })
      .catch(function (error) {
        console.log('error defineDiscountPercentageVoucher ============>', error);
      });

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/applyVoucher</div>

<div class="tab-end">
</div>

<div class="box-end">
</div>


## لیست و جستجو بن‌ تخفیف ها

با سرویس زیر امکان خواهید داشت در بین بن تخفیف‌های تعریف شده جستجو و آن را دریافت نمایید:

<br/>

توجه داشته باشید به ازای هر بن تخفیف، باید مقادیر تعداد، مبلغ، نام و توضیحات در پارامترهای جداگانه ارسال گردند.

<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            
            var output = new ResultSrv<List<VoucherSrv>>();
            var getVoucherListVo = GetVoucherListVo.ConcreteBuilder
                    .SetServiceCallParameters(internalServiceCallVo)
                    .SetOffset({Put your Offset})
                    .SetSize({Put your Size})
                    //.SetConsumerId({Put your ConsumerId})
                    //.SetHashCode("{Put your HashCode}")
                    //.SetVoucherName("{Put your Name}")
                    //.SetType({Put your VoucherType})
                    //.SetGuildCodes({Put your GuildCode})
                    //.SetCurrencyCode("Put your CurrencyCode")
                    //.SetAmountFrom({Put your AmountFrom})
                    //.SetAmountTo({Put your AmountTo})
                    //.SetDiscountPercentageFrom({Put your DiscountPercentageFrom})
                    //.SetDiscountPercentageTo({Put your DiscountPercentageTo})
                    //.SetExpireDateFrom("{Put your ExpireDateFrom}")
                    //.SetExpireDateTo("{ExpireDateTo}")
                    //.SetEntityId({Put your EntityId})
                    //.SetConsumeDateFrom("{Put your ConsumeDateFrom}")
                    //.SetConsumeDateTo("{Put your ConsumeDateTo}")
                    //.SetUsedAmountFrom({Put your UsedAmountFrom})
                    //.SetUsedAmountTo({Put your UsedAmountTo})
                    //.SetActive({Put your Active})
                    //.SetUsed({Put your Used})
                    .Build();
            BillingService.GetVoucherList(getVoucherListVo, response => Listener.GetResult(response, out output));
    }
catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/getVoucherList</div>

# [Java](#tab/java)

``` java
//List<String> scVoucherHashs =new ArrayList<>();
//scVoucherHashs.add("RFSFGDYEDYGS"); 
BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
        .setToken({token})
        .setToken_issuer(1)
        //.setScApiKey("SDFJKSHFJwshfJshfDJH")
        //.setScVoucherHash(scVoucherHashs)
        .build();

BillingService billingService = new BillingService();




try {
    GetVoucherListVo getVoucherListVo = new GetVoucherListVo.Builder(baseInfoVo)
            .setOffset({offset})
            .setSize({size})
            .setActive({true or false})
            .setAmountFrom({amountFrom})
            .setType(8)
            .build();
    billingService.getVoucherList(getVoucherListVo, new OnGetResponseListener<List<VoucherSrv>>() {
        @Override
        public void onResponse(ResultVo<List<VoucherSrv>> result) {
            System.out.println(result.getResult().get(2).getName());
        }

        @Override
        public void onFailed(PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    });
} 
catch (PodException e) {
    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
}

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/getVoucherList</div>

# [PHP](#tab/php)

``` php
$param =
        [
            'offset'                    => '{Put offset}',
        ## ==================== Optional Parameters  ==================
            'size'                      => '{Put output size}',
            'productId'                 => ['Put product ids'],
            'guildCode'                 => ['Put GUILD CODES'],
            'hash'                      => '{Put voucher hash}',
            'consumerId'                => '{Put user id}',
            'type'                      => '{Put voucher type}',
            'currencyCode'              => '{Put currency code}',
            'amountFrom'                => '{Put amount from}',
            'amountTo'                  => '{Put amount to}',
            'discountPercentageFrom'    => '{Put discount percentage from}',
            'discountPercentageTo'      => '{Put discount percentage to}',
            'expireDateFrom'            => '{Put expire date from (yyyy/mm/dd)}',
            'expireDateTo'              => '{Put expire date to (yyyy/mm/dd)}',
            'consumDateFrom'            => '{Put consume date from (yyyy/mm/dd)}',
            'consumDateTo'              => '{Put consume date to (yyyy/mm/dd)}',
            'usedAmountFrom'            => '{Put used amount from',
            'usedAmountTo'              => '{Put used amount to',
            'active'                    => '{true/false}',
            'used'                      => '{true/false}',
            'scVoucherHash'     	=> ['{Put Service Call Voucher Hashes}'],
            'scApiKey'           	=> '{Put service call Api Key}', 
    ];
    try {
        $result = $BillingService->getVoucherList($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/getVoucherList</div>

# [Nodejs](#tab/nodejs)

``` javascript

 let getVoucherListData = {
  // ------ REQUIRED ------
  offset: 0,

  // ------ OPTIONAL ------
  size: 0
  // consumerId: 0
  // hash: 'HASH'
  // name: 'NAME'
  // type: 0
  // guildCode: ['GUILD', 'GUILD']
  // currencyCode: 'CURRENCY'
  // amountFrom: 0
  // amountTo: 0
  // discountPercentageFrom: 0
  // discountPercentageTo: 0
  // expireDateFrom: 'YYYY/MM/DD'
  // expireDateTo: 'YYYY/MM/DD'
  // productId: [0, 0]
  // consumDateFrom: 'YYYY/MM/DD'
  // consumDateTo: 'YYYY/MM/DD'
  // usedAmountFrom: 0
  // usedAmountTo: 0
  // active: true | false
  // used: true | false
  // scVoucherHash: ['HASH#1', 'HASH#2']
  // token: 'API TOKEN'
  // tokenIssuer: 0 | 1
  // scApiKey: ' SC API KEY'
};

 podBillingService.getVoucherList(getVoucherListData)
      .then(function (result) {
        console.log('function: getVoucherList ============>', result, '\n');
      })
      .catch(function (error) {
        console.log('error getVoucherList ============>', error);
      });

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/getVoucherList</div>

<div class="tab-end">
</div>

<div class="box-end">
</div>


## فعال و غیرفعال‌ سازی بن تخفیف

سرویس زیر را جهت غیرفعال کردن بن تخفیف زودتر از موعد فراخوانی نمایید:

<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<VoucherSrv>();
            var activateVoucherVo = DeactivateVoucherVo.ConcreteBuilder
                    .SetServiceCallParameters(internalServiceCallVo)
                    .SetVoucherId({Put your VoucherId})
                    .Build();
            BillingService.ActivateVoucher(activateVoucherVo, response => Listener.GetResult(response, out output));
    }
catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/activateVoucher</div>

# [Java](#tab/java)

``` java
//List<String> scVoucherHashs =new ArrayList<>();
//scVoucherHashs.add("RFSFGDYEDYGS");
  BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
                .setToken({token})
                .setToken_issuer(1)
//.setScApiKey("SDFJKSHFJwshfJshfDJH")
//.setScVoucherHash(scVoucherHashs)
        .build();

BillingService billingService = new BillingService();

try {
    ActivateVoucherVo activateVoucherVo = new ActivateVoucherVo.Builder(baseInfoVo)
            .setVoucherId({id})
            .build();
    billingService.activateVoucher(activateVoucherVo, new OnGetResponseListener<VoucherSrv>() {
        @Override
        public void onResponse(ResultVo<VoucherSrv> result) {
            System.out.println(result.getResult().isActive());
        }

        @Override
        public void onFailed(PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    });
} 
catch (PodException e) {
    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
}

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/activateVoucher</div>

# [PHP](#tab/php)

``` php
$param =
        [
            ## ============================ *Required Parameters  =========================
            'id'     => '{Put voucher id}',
            ## =========================== Optional Parameters  ===========================
            'scVoucherHash'  => ["{Put Service Call Voucher Hash 1}", ...], # list of service call voucher hashes
        ];
    try {
        $result = $BillingService->activateVoucher($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/activateVoucher</div>

# [Nodejs](#tab/nodejs)

``` javascript
 let activateVoucherData = {
    // ------ REQUIRED ------
    id: 0

    // ------ OPTIONAL ------
    // scVoucherHash: ['HASH#1', 'HASH#2']
    // token: 'API TOKEN'
    // tokenIssuer: 0 | 1
    // scApiKey: ' SC API KEY'
  };

 podBillingService.activateVoucher(deactivateVoucherData)
      .then(function (result) {
        console.log('function: activateVoucher ============>', result, '\n');
      })
      .catch(function (error) {
        console.log('error activateVoucher ============>', error);
      });

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/activateVoucher</div>

<div class="tab-end">
</div>

<br/>

فعال نمودن مجدد بن تخفیف:

<div class="tab-start">
</div>

# [C#](#tab/csharp)

``` csharp
try
    {
        var internalServiceCallVo = InternalServiceCallVo.ConcreteBuilder
            .SetToken("{Put your ApiToken}")
            //.SetScVoucherHash({Put your VoucherHash})
            //.SetScApiKey("{Put your ApiKey}")
            .Build();
            var output = new ResultSrv<VoucherSrv>();
            var deactivateVoucherVo = DeactivateVoucherVo.ConcreteBuilder
                    .SetServiceCallParameters(internalServiceCallVo)
                   .SetVoucherId({Put your VoucherId})
                    .Build();
            BillingService.DeactivateVoucher(deactivateVoucherVo, response => Listener.GetResult(response, out output));
    }
catch (PodException podException)
    {
        Console.WriteLine($"-- {podException.Code}-an error has occured : 
                              {Environment.NewLine{podException.Message}");
        throw;
    }
catch (Exception exception)
    {
        Console.WriteLine(exception.Message);
        throw;
    }
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/deactivateVoucher</div>

# [Java](#tab/java)

``` java
//List<String> scVoucherHashs =new ArrayList<>();
//scVoucherHashs.add("RFSFGDYEDYGS");
BaseInfoVo baseInfoVo = new BaseInfoVo.Builder()
        .setToken({token})
        .setToken_issuer(1)
        //.setScApiKey("SDFJKSHFJwshfJshfDJH")
        //.setScVoucherHash(scVoucherHashs)
        .build();

BillingService billingService = new BillingService();




try {
    DeactivateVoucherVo deactivateVoucherVo = new DeactivateVoucherVo.Builder(baseInfoVo)
            .setVoucherId({id})
            .build();
    billingService.deactivateVoucher(deactivateVoucherVo, new OnGetResponseListener<VoucherSrv>() {
        @Override
        public void onResponse(ResultVo<VoucherSrv> result) {
            System.out.println(result.getResult().isActive());
        }

        @Override
        public void onFailed(PodException e) {
            System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
        }
    });
} 
catch (PodException e) {
    System.out.println("code : " + e.getCode() + "\nmessage : " + e.getMessage());
}

```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/deactivateVoucher</div>

# [PHP](#tab/php)

``` php
$param =
        [
            ## =================== *Required Parameters  ==================
            'id'     		=> '{Put voucher id}',
            ## =================== Optional Parameters  ===================
            'scVoucherHash'     => ['{Put Service Call Voucher Hashes}'],
            'scApiKey'          => '{Put service call Api Key}',        
];
    try {
        $result = $BillingService->deactivateVoucher($param);
        print_r($result);
    }
    catch (ValidationException $e) {
        print_r($e->getResult());
        print_r($e->getErrorsAsArray());
    } catch (PodException $e) {
        print_r($e->getResult());
    }
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/deactivateVoucher</div>

# [Nodejs](#tab/nodejs)

``` javascript
 let deactivateVoucherData = {
    // ------ REQUIRED ------
    id: 0

    // ------ OPTIONAL ------
    // scVoucherHash: ['HASH#1', 'HASH#2']
   // token: 'API TOKEN'
   // tokenIssuer: 0 | 1
   // scApiKey: ' SC API KEY'
  };

 podBillingService.deactivateVoucher(deactivateVoucherData)
      .then(function (result) {
        console.log('function: deactivateVoucher ============>', result, '\n');
      })
      .catch(function (error) {
        console.log('error deactivateVoucher ============>', error);
      });
```
<div class="swaggerLink">http://sandbox.pod.ir:8080/apidocs/swagger-ui.html?srv=/nzh/biz/deactivateVoucher</div>

<div class="tab-end">
</div>

<div class="box-end">
</div>


## لینک‌های مرتبط

- [مقدمه](/documents/introduction/)
- [مفاهیم](/documents/concepts/)
- [استاندارد و خطاها](/documents/errors/)
- [شروع به کار](/documents/get-started/)
- [پکیج‌ها](/documents/packages/)

<div class="box-end">
</div>

